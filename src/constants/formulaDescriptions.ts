export const FORMULAS = {
  // 수익 분석
  channelRevenue: {
    formula: '채널 수익 = 매출 - 변동비 - 고정비 배분',
    details: ['변동비: 수수료율 × 매출', '고정비: 채널별 월 고정비 / 일수 비례'],
  },
  productProfit: {
    formula: '품목 이익 = 공급가액 합계 - 매입원가 합계',
    details: ['매입원가 = 평균매입단가 × 판매수량', '마진율 = 이익 / 매출 × 100'],
  },
  productBEP: {
    formula: 'BEP 수량 = 고정비 배분 / (판매단가 - 변동비단가)',
    details: ['고정비: 매출비례 배분', '달성률 = 실제수량 / BEP수량 × 100'],
  },

  // 원가 관리
  costOverview: {
    formula: '총원가 = 원재료 + 부재료 + 노무비 + 경비',
    details: [
      '원재료/부재료: 기초재고 + 매입 - 기말재고',
      '노무비: 노무비시트 실데이터 (없으면 비율 추정)',
      '경비: 전기 + 수도 + 가스',
    ],
  },
  costScore: {
    formula: '점수 = (실적배수 / 목표배수) × 100',
    details: ['실적배수 = 매출 / 원가', '100점 이상 = 목표 달성', '목표금액: config 절대금액 × (기간일수/30)'],
  },
  rawMaterialTotal: {
    formula: '원재료 사용액 = 기초재고 + 당기매입 - 기말재고',
    details: ['ECOUNT 미연동 시 매입액만 사용 (폴백)', '품목별 상세는 매입 이력 기준'],
  },
  subMaterialTotal: {
    formula: '부재료 사용액 = 기초재고 + 당기매입 - 기말재고',
    details: ['부재료 분류: ZIP_S_ 코드 또는 포장/박스 등 키워드', 'ECOUNT 미연동 시 매입액만 사용'],
  },
  limitPrice: {
    formula: '한계단가 = 평균단가 + 1σ (표준편차)',
    details: ['현재단가 > 한계단가 → 가격 이상 징후', '초과율 = (현재 - 한계) / 한계 × 100%'],
  },

  // 생산/BOM
  weeklyProduction: {
    formula: '주간 생산량 = 일별 생산수량 합계',
    details: ['카테고리: 일반/전처리/냉동/소스/비빔밥', '일별→주간 집계로 추이 파악'],
  },
  wasteRate: {
    formula: '폐기율 = 폐기수량 / 생산수량 × 100%',
    details: ['완성품 폐기(EA) + 반제품 폐기(kg)', '목표: 폐기율 < 허용치(config)'],
  },
  bomVariance: {
    formula: '총오차 = 가격차이 + 수량차이',
    details: [
      '가격차이 = (실제단가 - 기준단가) × 실제수량',
      '수량차이 = (실제수량 - 기준수량) × 기준단가',
      '기준 = 전반기 평균, 실제 = 후반기',
      '기준수량: 전반기 투입비율 × 후반기 생산량',
    ],
  },
  bomAnomaly: {
    formula: '편차율 = (실제소모 - 기대소모) / 기대소모 × 100%',
    details: [
      '초과사용: 편차 > 15%',
      '미달사용: 편차 < -10%',
      '단가이상: |단가변동| > 20%',
      '심각도: ≥35% high / ≥20% medium / <20% low',
    ],
  },
  yieldRate: {
    formula: '수율 = 100% - 폐기율(%)',
    details: ['기준 수율 = 100 - 폐기 허용치', '수율 차이 = 실제 - 기준 (양수가 좋음)'],
  },
  adjustedCost: {
    formula: '환산단가 = 단위원가 / (수율/100)',
    details: ['수율 95%일 때: 5000 / 0.95 = 5,263원', '수율 손실 비용 = 폐기수량 × 단위원가'],
  },
  productivity: {
    formula: '생산성 = 생산수량 / 투입시간(또는 인원)',
    details: ['카테고리별 생산성 비교', '주간 집계로 추이 파악'],
  },

  // 재고
  statisticalOrder: {
    formula: 'ROP = μd×L + Z×√(L×σd² + μd²×σL²)',
    details: [
      'μd: 일평균 수요, σd: 수요 표준편차',
      'L: 리드타임(일), σL: 리드타임 편차',
      'Z: 서비스 수준에 따른 z-score',
      'EOQ = √(2×연수요×주문비용 / 보관비용)',
    ],
  },
  freshness: {
    formula: '신선도 = 최근성 + 재고회전율 + 수요안정성',
    details: ['0~100점, 5등급 (매우신선~경고)', '최근성: 최근 입고일 기준', '회전율: 출고량 / 평균재고'],
  },
  inventoryAnomaly: {
    formula: '이상징후 = |실재고 - 장부재고| / 장부재고',
    details: ['차이율이 임계값 초과 시 감지', '과잉/부족/불일치 분류'],
  },
} as const;
